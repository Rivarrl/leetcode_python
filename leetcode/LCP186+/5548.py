# -*- coding: utf-8 -*-
# ======================================
# @File    : 5548.py
# @Time    : 2020/10/25 11:01
# @Author  : Rivarrl
# ======================================
from algorithm_utils import *

class Solution:
    @timeit
    def minimumEffortPath(self, heights: List[List[int]]) -> int:
        import heapq
        stk = [[0, 0, 0]]
        dxy = [[0, 1], [0, -1], [1, 0], [-1, 0]]
        n = len(heights)
        m = len(heights[0])
        seen = [[False] * m for _ in range(n)]
        seen[0][0] = True
        res = [[0x3f3f3f3f] * m for _ in range(n)]
        while stk:
            t, i, j = heapq.heappop(stk)
            if i == n-1 and j == m-1:
                return t
            for dx, dy in dxy:
                x, y = i + dx, j + dy
                if 0 <= x < n and 0 <= y < m:
                    tt = max(t, abs(heights[x][y] - heights[i][j]))
                    if tt < res[x][y]:
                        res[x][y] = tt
                        heapq.heappush(stk, (tt, x, y))
        return 0 if res[-1][-1] == 0x3f3f3f3f else res[-1][-1]

if __name__ == '__main__':
    a = Solution()
    a.minimumEffortPath(heights = [[1,2,2],[3,8,2],[5,3,5]])
    a.minimumEffortPath(heights = [[1,2,3],[3,8,4],[5,3,5]])
    a.minimumEffortPath(heights = [[1,2,1,1,1],[1,2,1,2,1],[1,2,1,2,1],[1,2,1,2,1],[1,1,1,2,1]])
    a.minimumEffortPath([[869,55,270,479,856,956,31,202,120,625,971,800,954,726,184,566,484,578,572,870,91,10,692,403,7,719,818,522,481,221,187,120,140,14],[495,203,126,556,580,247,570,874,563,789,888,186,971,470,509,742,587,728,240,189,883,704,671,116,163,462,110,686,137,674,903,590,216,445],[948,976,555,959,172,823,66,641,816,622,913,24,692,112,222,276,509,407,770,211,878,390,104,610,88,67,771,916,141,412,744,479,642,575],[323,297,620,203,42,182,31,338,653,554,539,792,895,491,713,423,4,592,459,194,502,689,244,39,608,184,705,971,688,677,284,135,850,191],[379,123,172,96,618,96,980,760,89,800,786,904,734,90,795,776,844,732,871,90,158,724,384,261,697,802,740,946,113,725,547,583,548,827],[316,686,560,615,350,525,132,727,417,538,275,760,678,369,700,841,869,124,371,770,844,794,470,530,315,46,187,397,789,802,906,258,596,280],[644,345,810,529,671,74,536,942,309,696,656,932,73,765,91,137,230,306,708,19,217,832,416,877,383,88,555,439,475,634,276,110,63,264],[308,358,748,808,610,48,772,317,11,10,752,355,100,355,237,345,66,525,564,459,309,329,450,807,751,295,512,339,879,577,917,348,226,942],[290,541,432,677,851,211,335,590,833,999,205,137,752,921,384,308,552,896,449,280,921,965,689,892,621,130,750,696,852,629,835,131,609,848],[234,293,375,545,959,683,172,381,689,541,33,18,80,17,911,200,933,555,575,343,444,881,410,784,245,581,71,875,797,599,554,20,220,172],[954,524,942,699,601,264,660,232,856,1000,962,734,688,698,539,863,956,686,62,966,819,223,425,380,925,206,107,109,828,647,813,130,49,238],[285,225,584,409,810,82,1000,216,996,895,897,849,38,325,292,779,915,738,176,868,461,660,521,114,901,858,592,684,77,311,540,373,788,947],[548,438,183,620,326,183,734,936,867,140,29,110,796,670,460,772,145,516,246,580,118,896,69,643,422,879,71,332,76,565,100,243,768,595],[394,378,11,372,474,863,352,164,96,5,444,655,815,949,637,768,906,678,225,320,637,253,283,998,866,12,856,377,720,495,476,669,590,727],[47,998,724,244,650,262,574,831,781,828,357,253,944,516,757,513,90,301,472,57,394,260,191,6,714,717,954,529,418,464,419,557,172,624],[233,428,411,604,348,847,439,448,582,688,16,477,79,39,973,436,177,614,934,648,219,908,97,67,604,827,404,340,259,718,595,31,630,500],[544,987,994,926,484,15,918,215,521,677,589,916,222,332,433,559,418,718,721,715,39,682,612,40,712,111,959,631,63,180,93,649,152,216],[49,140,179,140,701,568,924,508,49,560,358,211,828,998,262,511,846,450,696,128,488,296,393,103,233,499,361,109,318,104,853,928,748,752],[909,970,66,285,164,822,160,980,899,130,401,748,739,1000,31,191,464,623,571,950,954,684,727,579,678,660,516,253,914,424,277,824,611,628],[650,495,930,731,246,611,37,402,313,941,107,693,325,728,233,651,766,398,817,16,166,440,354,909,403,831,549,583,974,875,961,582,281,575],[674,276,587,499,266,399,650,846,675,573,882,576,103,279,262,209,980,594,60,830,37,940,306,50,505,551,975,425,928,859,809,445,283,640],[881,301,816,522,657,616,885,952,960,197,921,742,30,4,965,51,579,483,283,543,37,152,352,683,112,390,737,884,181,435,135,934,756,939],[19,372,395,683,922,616,907,295,560,575,331,54,336,375,221,135,411,430,434,410,44,598,714,736,846,699,777,577,876,611,689,892,660,469],[950,182,957,459,103,988,245,825,252,645,707,853,995,375,826,948,826,26,690,724,700,220,788,948,736,936,355,231,482,856,855,377,789,135],[50,649,686,288,269,579,887,320,360,939,808,508,264,2,336,571,554,52,304,162,859,548,405,325,605,163,799,500,558,307,120,61,220,826],[910,773,238,980,509,644,488,354,838,388,551,164,947,262,65,184,617,386,16,667,335,729,145,130,834,872,926,4,612,822,983,161,325,487],[701,512,194,180,843,552,625,544,455,226,904,502,912,341,581,360,61,830,115,65,173,970,198,97,268,665,556,768,235,534,657,32,716,796],[349,745,511,213,385,852,97,334,602,281,122,535,656,296,636,95,979,249,804,913,747,55,651,974,53,200,981,152,574,432,420,427,221,814],[23,989,485,40,31,359,682,246,182,667,114,520,562,578,156,321,999,661,56,879,700,753,290,527,515,932,714,369,269,758,795,959,98,401],[677,538,424,952,598,615,8,649,928,503,632,432,822,68,383,243,719,358,60,11,447,314,553,616,755,665,826,226,265,331,691,689,227,45],[787,115,809,967,960,954,426,412,465,394,944,78,577,283,120,63,224,818,420,399,218,629,817,715,402,551,415,286,388,831,879,720,86,704],[619,324,850,763,212,393,412,259,822,317,419,130,310,798,355,504,98,762,141,523,442,668,862,51,313,482,202,643,999,266,152,316,314,663],[364,690,222,857,332,466,565,226,595,958,818,889,668,303,322,100,516,753,792,295,83,25,421,386,478,895,369,998,278,63,899,87,142,129],[538,768,51,224,867,64,691,200,34,766,564,11,637,991,792,706,928,280,31,209,49,190,260,672,905,219,571,632,673,697,878,15,511,737],[47,313,507,174,323,362,966,850,797,852,400,26,196,358,96,987,728,666,194,854,85,839,224,54,414,373,665,184,110,264,872,297,390,969],[633,535,100,354,140,433,863,19,874,681,428,103,791,557,170,954,858,636,858,768,696,682,891,760,46,336,340,894,744,580,604,391,241,771],[458,587,372,424,456,237,395,416,138,625,82,261,124,718,960,504,675,427,90,665,563,235,273,103,412,443,807,274,196,898,883,722,849,115],[923,59,868,863,333,838,376,464,689,974,927,605,511,571,700,198,277,72,224,914,711,606,844,352,701,310,728,444,986,239,520,169,80,75],[171,293,216,884,637,275,741,231,722,630,621,28,383,685,629,178,663,89,742,476,757,108,663,591,260,71,363,687,440,512,177,716,794,511],[870,545,753,641,666,255,859,573,957,135,330,371,818,242,92,649,947,844,268,106,283,620,471,45,90,961,925,65,631,441,816,15,293,777],[658,489,12,672,798,706,378,711,700,653,512,150,638,719,327,806,438,472,938,299,635,836,364,314,795,2,148,81,596,619,443,594,463,542],[274,329,265,432,740,465,943,216,885,176,296,165,798,382,265,298,694,647,484,233,429,587,332,416,54,108,267,761,879,847,612,686,709,20],[247,354,478,648,363,740,510,29,320,808,264,471,987,12,550,820,247,962,932,841,513,222,905,354,622,139,841,667,984,981,365,986,606,910],[737,563,158,680,42,202,485,829,434,720,108,109,448,819,354,377,538,756,853,971,628,921,66,697,860,567,607,24,63,31,444,52,821,566],[767,474,755,981,833,780,696,953,854,58,285,913,215,824,813,97,276,462,818,477,808,925,309,764,375,532,356,447,443,287,457,214,42,980],[798,7,262,692,673,574,586,119,963,771,817,687,317,347,789,448,306,48,560,935,162,515,354,425,532,932,149,196,136,429,453,92,486,547],[788,274,446,909,767,892,91,161,600,528,143,786,545,198,33,733,121,822,769,132,708,486,684,363,79,122,234,43,319,2,953,114,173,873],[338,523,347,970,219,793,576,603,369,586,560,549,671,910,307,111,364,770,119,995,408,511,391,810,910,514,375,437,849,32,678,654,773,242],[665,171,891,446,764,506,430,463,890,859,196,933,807,952,66,455,74,707,941,419,234,130,333,715,22,504,551,346,335,914,914,853,975,126],[554,915,421,317,774,750,388,167,897,643,698,599,135,655,970,703,638,449,689,970,290,549,683,241,207,696,979,629,608,61,646,503,228,238],[994,874,695,751,566,707,419,948,293,716,762,235,54,37,712,612,437,218,508,659,515,210,297,843,842,835,381,375,32,314,935,847,954,268],[519,788,20,996,64,497,532,976,284,508,676,163,367,826,555,574,852,578,290,504,997,215,497,403,920,321,973,188,105,373,609,861,50,449],[485,921,323,717,364,249,962,411,693,654,454,383,715,303,610,112,434,141,925,571,643,768,947,276,518,455,3,1,431,779,169,870,334,3],[186,416,263,596,605,192,191,423,660,693,993,981,836,256,530,270,581,168,411,70,528,768,787,268,441,256,763,669,33,741,510,15,433,777],[298,554,115,312,723,98,817,514,239,629,108,430,733,378,25,227,548,302,547,741,217,832,196,798,903,722,191,229,810,257,654,914,974,110],[536,876,667,402,68,313,794,588,680,526,528,171,625,889,432,264,80,626,916,528,377,137,919,501,967,932,997,590,297,854,921,27,488,603],[999,847,936,481,325,199,907,897,678,688,672,466,103,308,206,94,744,545,514,54,680,653,584,877,959,324,460,200,849,787,957,385,168,531],[368,551,568,371,746,304,934,149,805,533,787,928,304,263,187,854,435,619,871,794,995,961,527,70,166,221,90,5,804,766,860,762,530,648],[302,523,659,1,104,584,269,61,667,529,957,758,592,308,263,714,801,16,284,535,432,192,478,715,343,189,339,298,375,880,127,431,609,47],[717,409,393,177,416,586,639,170,432,665,620,11,182,850,435,503,345,921,627,537,848,548,605,679,896,761,680,828,372,274,926,422,710,553],[404,431,977,531,402,811,158,422,410,394,818,55,429,982,805,619,598,439,593,670,275,809,20,806,124,611,39,120,422,245,827,99,380,999],[897,140,462,948,845,788,476,880,558,893,324,113,319,700,795,306,786,386,256,447,288,21,995,653,35,471,929,874,886,11,631,580,658,942],[290,423,317,542,512,929,718,599,175,482,471,500,101,908,641,919,12,403,646,983,819,427,170,732,705,436,805,40,342,280,155,80,882,954],[750,463,232,913,623,433,560,62,30,175,742,876,239,542,24,281,295,232,651,268,294,294,2,570,274,505,190,802,349,718,969,478,665,738],[724,119,989,716,760,15,338,622,638,513,816,357,105,111,431,129,44,230,57,741,664,703,319,156,891,63,164,165,417,649,247,199,280,494],[926,714,779,585,787,315,161,319,636,249,475,340,152,655,267,197,548,104,343,638,376,386,524,606,387,16,842,561,473,343,699,989,22,260]])